---
---
<section class="relative flex min-h-screen items-center overflow-hidden">
  <div class="absolute inset-0 overflow-hidden">
    <img src="/Website2026/images/hero-mobile.svg" alt="Night power grid and electricians" class="h-full w-full object-cover" />
    <iframe
      id="hero-video-iframe"
      class="absolute left-1/2 top-1/2 h-[56.25vw] min-h-full w-[177.78vh] min-w-full -translate-x-1/2 -translate-y-1/2 brightness-140 contrast-112 saturate-120 blur-[1px]"
      data-video-id="jkLZ5O1REY4"
      src="https://www.youtube-nocookie.com/embed/jkLZ5O1REY4?autoplay=1&mute=1&loop=1&playlist=jkLZ5O1REY4&controls=0&modestbranding=1&playsinline=1&rel=0&iv_load_policy=3&vq=hd2160&enablejsapi=1&start=120"
      title="Electrical infrastructure background"
      loading="eager"
      allow="autoplay; encrypted-media; fullscreen; picture-in-picture"
      referrerpolicy="strict-origin-when-cross-origin"
    ></iframe>
  </div>
  <div class="hero-overlay absolute inset-0"></div>
  <div class="hero-edge-vignette absolute inset-0"></div>

  <div class="container-shell relative z-20 py-20">
    <h1 class="section-title max-w-4xl font-black">إصلاح الكهرباء</h1>
    <p class="mt-4 text-lg text-white/88">Wired for Excellence.</p>
  </div>

  <script is:inline>
    const buildVideoUrl = (videoId, startSeconds) => {
      const params = new URLSearchParams({
        autoplay: '1',
        mute: '1',
        loop: '1',
        playlist: videoId,
        controls: '0',
        modestbranding: '1',
        playsinline: '1',
        rel: '0',
        iv_load_policy: '3',
        start: String(startSeconds),
        vq: 'hd2160',
        enablejsapi: '1',
        origin: window.location.origin,
      });

      return `https://www.youtube-nocookie.com/embed/${videoId}?${params.toString()}`;
    };

    const postPlayerCommand = (iframe, func, args = []) => {
      iframe.contentWindow?.postMessage(
        JSON.stringify({ event: 'command', func, args }),
        '*',
      );
    };

    const requestBestQuality = (iframe) => {
      postPlayerCommand(iframe, 'setPlaybackQualityRange', ['highres']);
      postPlayerCommand(iframe, 'setPlaybackQuality', ['highres']);
      postPlayerCommand(iframe, 'setPlaybackQualityRange', ['hd2160']);
      postPlayerCommand(iframe, 'setPlaybackQuality', ['hd2160']);
      postPlayerCommand(iframe, 'setPlaybackQualityRange', ['hd1440']);
      postPlayerCommand(iframe, 'setPlaybackQuality', ['hd1440']);
    };

    const attemptAutoplay = (iframe) => {
      postPlayerCommand(iframe, 'mute');
      requestBestQuality(iframe);
      postPlayerCommand(iframe, 'playVideo');
    };

    const setVideoSource = (startSeconds) => {
      const iframe = document.getElementById('hero-video-iframe');
      if (!(iframe instanceof HTMLIFrameElement)) return;

      const videoId = iframe.dataset.videoId;
      if (!videoId) return;

      iframe.src = buildVideoUrl(videoId, startSeconds);
    };

    const hydrateHeroVideo = () => {
      const iframe = document.getElementById('hero-video-iframe');
      if (!(iframe instanceof HTMLIFrameElement)) return;

      const randomStart = Math.floor(45 + Math.random() * 210);
      setVideoSource(randomStart);
      iframe.onload = () => {
        let tries = 0;
        const timer = window.setInterval(() => {
          attemptAutoplay(iframe);
          tries += 1;
          if (tries >= 8) window.clearInterval(timer);
        }, 400);
      };

      window.setTimeout(() => {
        const frame = document.getElementById('hero-video-iframe');
        if (!(frame instanceof HTMLIFrameElement)) return;
        if (!frame.src) setVideoSource(randomStart);
        attemptAutoplay(frame);
      }, 1200);

      window.setTimeout(() => {
        const frame = document.getElementById('hero-video-iframe');
        if (!(frame instanceof HTMLIFrameElement)) return;
        requestBestQuality(frame);
      }, 2400);
    };

    hydrateHeroVideo();
    document.addEventListener('astro:page-load', hydrateHeroVideo);
  </script>
</section>
