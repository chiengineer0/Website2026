---
import { getCollection, render } from 'astro:content';
import SiteLayout from '@/layouts/SiteLayout.astro';
import TrustBadgeStrip from '@/components/sections/TrustBadgeStrip.astro';
import { StickyQuoteCta } from '@/components/islands/StickyQuoteCta';

export async function getStaticPaths() {
  const services = await getCollection('services');
  return services.map((service) => ({ params: { slug: service.slug }, props: { service } }));
}

const { service } = Astro.props;
const { Content } = await render(service);
const breadcrumbSchema = {
  '@context': 'https://schema.org',
  '@type': 'BreadcrumbList',
  itemListElement: [
    { '@type': 'ListItem', position: 1, name: 'Home', item: 'https://chiengineer0.github.io/Website2026/' },
    { '@type': 'ListItem', position: 2, name: 'Services', item: 'https://chiengineer0.github.io/Website2026/services/' },
    { '@type': 'ListItem', position: 3, name: service.data.title, item: `https://chiengineer0.github.io/Website2026/services/${service.slug}/` },
  ],
};
const aggregateRatingSchema = {
  '@context': 'https://schema.org',
  '@type': 'Service',
  name: service.data.title,
  provider: { '@type': 'Electrician', name: '[BRAND NAME] Electric' },
  aggregateRating: { '@type': 'AggregateRating', ratingValue: '4.9', reviewCount: '187' },
};
---
<SiteLayout title={`${service.data.title} | [BRAND NAME] Electric`} description={service.data.description}>
  <script is:inline type="application/ld+json" set:html={JSON.stringify(breadcrumbSchema)} />
  <script is:inline type="application/ld+json" set:html={JSON.stringify(aggregateRatingSchema)} />
  <article class="container-shell py-16">
    <nav class="text-xs text-white/55" aria-label="Breadcrumbs">
      <a href="/Website2026/" class="hover:text-white">Home</a> / <a href="/Website2026/services/" class="hover:text-white">Services</a> / <span class="text-white/80">{service.data.title}</span>
    </nav>
    <h1 class="section-title mt-4 font-black">{service.data.title}</h1>
    <p class="mt-3 text-white/80">{service.data.description}</p>
    <div class="surface-card mt-6 grid gap-3 p-5 sm:grid-cols-3">
      <p><strong>Timeline:</strong><br />{service.data.timeline}</p>
      <p><strong>Investment:</strong><br />{service.data.startingPrice}</p>
      <p><strong>Service Class:</strong><br />{service.data.category}</p>
    </div>
    <div class="prose prose-invert mt-8 max-w-none">
      <Content />
    </div>
    <div class="mt-8">
      <TrustBadgeStrip />
    </div>
    <div class="mt-8 flex flex-wrap gap-3">
      <a href="/Website2026/quote/" class="inline-flex min-h-12 items-center rounded-md bg-[var(--color-amber)] px-6 font-bold text-black">Request This Service</a>
      <a href="tel:+15551239876" class="inline-flex min-h-12 items-center rounded-md border border-red-300/50 px-6 font-semibold text-red-200">Emergency Call</a>
    </div>
    <StickyQuoteCta client:idle label="Book This Service" />
  </article>
</SiteLayout>
