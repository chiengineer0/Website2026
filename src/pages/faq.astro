---
import { getCollection } from 'astro:content';
import SiteLayout from '@/layouts/SiteLayout.astro';
import { FaqAccordion } from '@/components/islands/FaqAccordion';

const items = await getCollection('faq');
const faqSchema = {
  '@context': 'https://schema.org',
  '@type': 'FAQPage',
  mainEntity: items.map((item) => ({
    '@type': 'Question',
    name: item.data.question,
    acceptedAnswer: {
      '@type': 'Answer',
      text: item.data.answer,
    },
  })),
};
---
<SiteLayout title="FAQ | [BRAND NAME] Electric" description="Answers about pricing, safety, process, licensing, and emergency service.">
  <script type="application/ld+json" set:html={JSON.stringify(faqSchema)} />
  <section class="container-shell py-16">
    <h1 class="text-4xl font-black">Frequently Asked Questions</h1>
    <p class="mt-3 text-white/80">Use CMD+K search to instantly find any topic across all site content.</p>
    <div class="mt-8 rounded-xl border border-white/15 bg-white/5 p-5">
      <FaqAccordion client:load items={items.map((item) => ({ id: item.id, question: item.data.question, answer: item.data.answer, category: item.data.category }))} />
    </div>
  </section>
</SiteLayout>
